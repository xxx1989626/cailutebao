{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="card shadow border-0">
        <div class="card-header bg-primary text-white text-center py-3">
            <h5 class="mb-0">资产快捷盘点</h5>
        </div>
        <div class="card-body text-center">
            <h3 class="mt-2">{{ asset.asset_info.name }}</h3>
            <p class="text-muted">SN: {{ asset.sn_number }}</p>
            <hr>
            
            <div class="mb-4">
                <p class="small text-start fw-bold">选择当前状态：</p>
                <div class="d-grid gap-3">
                    <button onclick="submitCheck('正常')" class="btn btn-lg btn-success py-3">
                        <i class="bi bi-check-circle"></i> 状态正常
                    </button>
                    <button onclick="submitCheck('维修')" class="btn btn-lg btn-warning py-3">
                        <i class="bi bi-tools"></i> 需要维修
                    </button>
                    <button onclick="submitCheck('报废')" class="btn btn-lg btn-danger py-3">
                        <i class="bi bi-trash"></i> 资产报废/丢失
                    </button>
                </div>
            </div>
            <a href="{{ url_for('asset.asset_list') }}" class="btn btn-link">取消盘点</a>
        </div>
    </div>
</div>

<script>
function submitCheck(status) {
    // 复用你已经写好的 update_inventory 接口
    fetch(`/asset/inventory/update/{{ asset.id }}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ "status": status })
    }).then(res => res.json()).then(data => {
        if (data.status === 'success') {
            alert('盘点成功！');
            window.location.href = "/asset/inventory"; // 盘点完跳转到列表查看结果
        } else {
            alert('提交失败：' + data.message);
        }
    });
}
</script>
{% endblock %}