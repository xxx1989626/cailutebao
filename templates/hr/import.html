<!-- templates/hr/import.html -->
{% extends "base.html" %}
{% block title %}导入名单{% endblock %}
{% block content %}
<style>
    /* 导入页面专属样式 */
    .import-card {
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .import-header {
        background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%) !important;
        padding: 1rem 1.5rem;
        border-bottom: none;
    }
    
    .import-body {
        padding: 2rem;
    }
    
    .file-input {
        border-radius: 8px;
        padding: 0.6rem 0.75rem;
    }
    
    .action-btn {
        padding: 0.6rem 2rem;
        border-radius: 8px;
        font-weight: 500;
        transition: all 0.2s ease;
        margin-right: 0.5rem;
    }
    
    .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .file-info {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 1rem;
        margin-top: 1rem;
        border-left: 4px solid #0d6efd;
    }
    
    @media (max-width: 768px) {
        .import-body {
            padding: 1rem;
        }
        
        .action-btn {
            width: 100%;
            margin-bottom: 0.5rem;
            margin-right: 0;
        }
    }
</style>

<div class="container mt-4 mb-5">
    <div class="card import-card shadow">
        <div class="card-header import-header text-white d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
                <i class="bi bi-file-excel-fill me-2"></i>批量导入员工名单
            </h4>
            <a href="{{ url_for('hr.hr_list') }}" class="btn btn-light btn-sm">
                <i class="bi bi-arrow-left me-1"></i>返回列表
            </a>
        </div>
        <div class="card-body import-body">
            <form method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
                <div class="mb-4">
                    <label class="form-label fw-medium">
                        <i class="bi bi-file-earmark-excel me-1"></i> 选择Excel文件
                        <span class="text-danger">*</span>
                    </label>
                    <input type="file" name="file" class="form-control file-input" accept=".xlsx, .xls" required>
                    
                    <div class="file-info mt-2">
                        <h6 class="mb-2 text-primary">
                            <i class="bi bi-info-circle me-1"></i> 文件格式要求
                        </h6>
                        <ul class="mb-0 text-muted">
                            <li><strong>必填列：</strong>姓名、身份证号码、手机号</li>
                            <li><strong>可选列：</strong>职务、岗位、薪资模式</li>
                            <li><strong>文件格式：</strong>仅支持 .xlsx 或 .xls 格式</li>
                            <li><strong>编码格式：</strong>建议使用UTF-8编码</li>
                        </ul>
                    </div>
                </div>
                
                <div class="mt-4 pt-3 border-top">
                    <button type="submit" class="btn btn-success action-btn">
                        <i class="bi bi-upload me-1"></i>开始导入
                    </button>
                    <a href="{{ url_for('hr.hr_list') }}" class="btn btn-secondary action-btn">
                        <i class="bi bi-x-circle me-1"></i>取消
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // 表单验证
    (() => {
        'use strict'
        const forms = document.querySelectorAll('.needs-validation')
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault()
                    event.stopPropagation()
                }
                form.classList.add('was-validated')
            }, false)
        })
    })()

    // 文件选择提示
    document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.querySelector('input[name="file"]');
        if (fileInput) {
            fileInput.addEventListener('change', function() {
                if (this.files && this.files[0]) {
                    const fileName = this.files[0].name;
                    const fileSize = (this.files[0].size / 1024 / 1024).toFixed(2);
                    
                    // 检查文件大小（限制10MB）
                    if (fileSize > 10) {
                        alert(`文件大小(${fileSize}MB)超过限制(10MB)，请选择更小的文件`);
                        this.value = '';
                        return;
                    }
                    
                    // 检查文件格式
                    const ext = fileName.split('.').pop().toLowerCase();
                    if (!['xlsx', 'xls'].includes(ext)) {
                        alert('请选择有效的Excel文件（.xlsx 或 .xls 格式）');
                        this.value = '';
                        return;
                    }
                }
            });
        }
    });
</script>
{% endblock %}